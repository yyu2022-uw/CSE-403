{"version":3,"names":["_react","require","_ChatContext","_TranslationContext","_hooks","_useTranslatedMessage","_utils","selector","nextValue","createdBy","created_by","latestVotesByOption","latest_votes_by_option","name","getMessageSenderName","message","currentUserId","t","membersLength","_message$user","user","id","_message$user2","_message$user3","_message$user4","username","getMentionUsers","mentionedUser","Array","isArray","mentionUserString","reduce","acc","cur","userName","concat","length","replace","match","getLatestMessageDisplayText","channel","client","pollState","_message$attachments","bold","text","isMessageTypeDeleted","type","userID","members","Object","keys","state","messageSender","messageSenderText","boldOwner","includes","shortenedText","substring","mentionedUsers","mentioned_users","regEx","RegExp","_toConsumableArray2","split","index","test","push","command","attachments","poll_id","_latestVotes$","_previewUser","_previewUser2","latestVotes","values","map","votes","sort","a","b","Date","created_at","getTime","previewAction","previewUser","_latestVotes$2","previewMessage","MessageReadStatus","exports","getLatestMessageReadStatus","readEvents","_message$user5","NOT_SENT_BY_CURRENT_USER","readList","assign","read","messageUpdatedAt","updated_at","undefined","some","_ref","last_read","READ","UNREAD","getLatestMessagePreview","params","lastMessage","messages","messageObject","previews","status","channelStateLastMessage","useLatestMessagePreview","forceUpdate","_lastMessage$poll_id","_useStateStore","_useChatContext","useChatContext","_useTranslationContex","useTranslationContext","channelConfigExists","getConfig","translatedLastMessage","useTranslatedMessage","channelLastMessageString","stringifyMessage","_useState","useState","_useState2","_slicedToArray2","setReadEvents","_useState3","_useState4","latestMessagePreview","setLatestMessagePreview","readStatus","useEffect","_channel$getConfig","read_events","disconnected","pollId","poll","polls","fromState","useStateStore"],"sourceRoot":"../../../../../src","sources":["components/ChannelPreview/hooks/useLatestMessagePreview.ts"],"mappings":";;;;;;;AAAA,IAAAA,MAAA,GAAAC,OAAA;AAaA,IAAAC,YAAA,GAAAD,OAAA;AACA,IAAAE,mBAAA,GAAAF,OAAA;AAEA,IAAAG,MAAA,GAAAH,OAAA;AACA,IAAAI,qBAAA,GAAAJ,OAAA;AAEA,IAAAK,MAAA,GAAAL,OAAA;AA0BA,IAAMM,QAAQ,GAAG,SAAXA,QAAQA,CACZC,SAAwC;EAAA,OACI;IAC5CC,SAAS,EAAED,SAAS,CAACE,UAAU;IAC/BC,mBAAmB,EAAEH,SAAS,CAACI,sBAAsB;IACrDC,IAAI,EAAEL,SAAS,CAACK;EAClB,CAAC;AAAA,CAAC;AAEF,IAAMC,oBAAoB,GAAG,SAAvBA,oBAAoBA,CAGxBC,OAAsD,EACtDC,aAAiC,EACjCC,CAA0B,EAC1BC,aAAqB,EAClB;EAAA,IAAAC,aAAA;EACH,IAAI,CAAAJ,OAAO,qBAAAI,aAAA,GAAPJ,OAAO,CAAEK,IAAI,qBAAbD,aAAA,CAAeE,EAAE,MAAKL,aAAa,EAAE;IACvC,OAAOC,CAAC,CAAC,KAAK,CAAC;EACjB;EAEA,IAAIC,aAAa,GAAG,CAAC,EAAE;IAAA,IAAAI,cAAA,EAAAC,cAAA,EAAAC,cAAA;IACrB,OAAO,CAAAT,OAAO,qBAAAO,cAAA,GAAPP,OAAO,CAAEK,IAAI,qBAAbE,cAAA,CAAeT,IAAI,MAAIE,OAAO,qBAAAQ,cAAA,GAAPR,OAAO,CAAEK,IAAI,qBAAbG,cAAA,CAAeE,QAAQ,MAAIV,OAAO,qBAAAS,cAAA,GAAPT,OAAO,CAAEK,IAAI,qBAAbI,cAAA,CAAeH,EAAE,KAAI,EAAE;EAClF;EAEA,OAAO,EAAE;AACX,CAAC;AAED,IAAMK,eAAe,GAAG,SAAlBA,eAAeA,CAGnBC,aAA6D,EAC1D;EACH,IAAIC,KAAK,CAACC,OAAO,CAACF,aAAa,CAAC,EAAE;IAChC,IAAMG,iBAAiB,GAAGH,aAAa,CAACI,MAAM,CAAC,UAACC,GAAG,EAAEC,GAAG,EAAK;MAC3D,IAAMC,QAAQ,GAAGD,GAAG,CAACpB,IAAI,IAAIoB,GAAG,CAACZ,EAAE,IAAI,EAAE;MACzC,IAAIa,QAAQ,EAAE;QACZF,GAAG,OAAAG,MAAA,CAAOH,GAAG,CAACI,MAAM,GAAG,GAAG,GAAG,EAAE,OAAAD,MAAA,CAAID,QAAQ,CAAE;MAC/C;MACA,OAAOF,GAAG;IACZ,CAAC,EAAE,EAAE,CAAC;IAGN,OAAOF,iBAAiB,CAACO,OAAO,CAAC,qBAAqB,EAAE,UAAUC,KAAK,EAAE;MACvE,OAAO,IAAI,GAAGA,KAAK;IACrB,CAAC,CAAC;EACJ;EAEA,OAAO,EAAE;AACX,CAAC;AAED,IAAMC,2BAA2B,GAAG,SAA9BA,2BAA2BA,CAG/BC,OAAoC,EACpCC,MAAsC,EACtC1B,OAAsD,EACtDE,CAA0B,EAC1ByB,SAA6D,EAC1D;EAAA,IAAAC,oBAAA;EACH,IAAI,CAAC5B,OAAO,EAAE,OAAO,CAAC;IAAE6B,IAAI,EAAE,KAAK;IAAEC,IAAI,EAAE5B,CAAC,CAAC,gBAAgB;EAAE,CAAC,CAAC;EACjE,IAAM6B,oBAAoB,GAAG/B,OAAO,CAACgC,IAAI,KAAK,SAAS;EACvD,IAAID,oBAAoB,EAAE,OAAO,CAAC;IAAEF,IAAI,EAAE,KAAK;IAAEC,IAAI,EAAE5B,CAAC,CAAC,iBAAiB;EAAE,CAAC,CAAC;EAC9E,IAAMD,aAAa,GAAGyB,MAAM,oBAANA,MAAM,CAAEO,MAAM;EACpC,IAAMC,OAAO,GAAGC,MAAM,CAACC,IAAI,CAACX,OAAO,CAACY,KAAK,CAACH,OAAO,CAAC;EAElD,IAAMI,aAAa,GAAGvC,oBAAoB,CAACC,OAAO,EAAEC,aAAa,EAAEC,CAAC,EAAEgC,OAAO,CAACb,MAAM,CAAC;EACrF,IAAMkB,iBAAiB,GAAGD,aAAa,MAAAlB,MAAA,CAChCkB,aAAa,KAAKpC,CAAC,CAAC,KAAK,CAAC,GAAG,EAAE,GAAG,GAAG,EAAAkB,MAAA,CAAGkB,aAAa,UACxD,EAAE;EACN,IAAME,SAAS,GAAGD,iBAAiB,CAACE,QAAQ,CAAC,GAAG,CAAC;EACjD,IAAIzC,OAAO,CAAC8B,IAAI,EAAE;IAEhB,IAAMY,aAAa,GAAG1C,OAAO,CAAC8B,IAAI,CAACa,SAAS,CAAC,CAAC,EAAE,GAAG,CAAC,CAACrB,OAAO,CAAC,KAAK,EAAE,GAAG,CAAC;IACxE,IAAMsB,cAAc,GAAGjC,eAAe,CAACX,OAAO,CAAC6C,eAAe,CAAC;IAC/D,IAAMC,KAAK,GAAG,IAAIC,MAAM,MAAA3B,MAAA,CAAMwB,cAAc,MAAG,CAAC;IAChD,QACE;MAAEf,IAAI,EAAEW,SAAS;MAAEV,IAAI,EAAES;IAAkB,CAAC,EAAAnB,MAAA,KAAA4B,mBAAA,aACzCN,aAAa,CAACO,KAAK,CAAC,EAAE,CAAC,CAACjC,MAAM,CAC/B,UAACC,GAAG,EAAEC,GAAG,EAAEgC,KAAK,EAAK;MACnB,IAAIhC,GAAG,KAAK,GAAG,IAAI0B,cAAc,IAAIE,KAAK,CAACK,IAAI,CAACT,aAAa,CAACC,SAAS,CAACO,KAAK,CAAC,CAAC,EAAE;QAC/EjC,GAAG,CAACmC,IAAI,CAAC;UAAEvB,IAAI,EAAE,IAAI;UAAEC,IAAI,EAAEZ;QAAI,CAAC,CAAC;MACrC,CAAC,MAAM,IAAI0B,cAAc,IAAIE,KAAK,CAACK,IAAI,CAAClC,GAAG,CAACA,GAAG,CAACI,MAAM,GAAG,CAAC,CAAC,CAACS,IAAI,CAAC,EAAE;QACjEb,GAAG,CAACmC,IAAI,CAAC;UAAEvB,IAAI,EAAE,KAAK;UAAEC,IAAI,EAAEZ;QAAI,CAAC,CAAC;MACtC,CAAC,MAAM;QACLD,GAAG,CAACA,GAAG,CAACI,MAAM,GAAG,CAAC,CAAC,CAACS,IAAI,IAAIZ,GAAG;MACjC;MACA,OAAOD,GAAG;IACZ,CAAC,EACD,CAAC;MAAEY,IAAI,EAAE,KAAK;MAAEC,IAAI,EAAE;IAAG,CAAC,CAC5B,CAAC;EAEL;EACA,IAAI9B,OAAO,CAACqD,OAAO,EAAE;IACnB,OAAO,CACL;MAAExB,IAAI,EAAEW,SAAS;MAAEV,IAAI,EAAES;IAAkB,CAAC,EAC5C;MAAEV,IAAI,EAAE,KAAK;MAAEC,IAAI,MAAAV,MAAA,CAAMpB,OAAO,CAACqD,OAAO;IAAG,CAAC,CAC7C;EACH;EACA,KAAAzB,oBAAA,GAAI5B,OAAO,CAACsD,WAAW,aAAnB1B,oBAAA,CAAqBP,MAAM,EAAE;IAC/B,OAAO,CACL;MAAEQ,IAAI,EAAEW,SAAS;MAAEV,IAAI,EAAES;IAAkB,CAAC,EAC5C;MAAEV,IAAI,EAAE,KAAK;MAAEC,IAAI,EAAE5B,CAAC,CAAC,kBAAkB;IAAE,CAAC,CAC7C;EACH;EACA,IAAIF,OAAO,CAACuD,OAAO,IAAI5B,SAAS,EAAE;IAAA,IAAA6B,aAAA,EAAAC,YAAA,EAAAC,aAAA;IAChC,IAAQhE,SAAS,GAAgCiC,SAAS,CAAlDjC,SAAS;MAAEE,mBAAmB,GAAW+B,SAAS,CAAvC/B,mBAAmB;MAAEE,IAAI,GAAK6B,SAAS,CAAlB7B,IAAI;IAC5C,IAAI6D,WAAW;IACf,IAAI/D,mBAAmB,EAAE;MACvB+D,WAAW,GAAGxB,MAAM,CAACyB,MAAM,CAAChE,mBAAmB,CAAC,CAC7CiE,GAAG,CAAC,UAACC,KAAK;QAAA,OAAKA,KAAK,oBAALA,KAAK,CAAG,CAAC,CAAC;MAAA,EAAC,CAC1BC,IAAI,CAAC,UAACC,CAAC,EAAEC,CAAC;QAAA,OAAK,IAAIC,IAAI,CAACD,CAAC,CAACE,UAAU,CAAC,CAACC,OAAO,CAAC,CAAC,GAAG,IAAIF,IAAI,CAACF,CAAC,CAACG,UAAU,CAAC,CAACC,OAAO,CAAC,CAAC;MAAA,EAAC;IACxF;IACA,IAAIC,aAAa,GAAG,SAAS;IAC7B,IAAIC,WAAW,GAAG5E,SAAS;IAC3B,IAAIiE,WAAW,IAAIA,WAAW,CAACtC,MAAM,KAAAmC,aAAA,GAAIG,WAAW,CAAC,CAAC,CAAC,aAAdH,aAAA,CAAgBnD,IAAI,EAAE;MAAA,IAAAkE,cAAA;MAC7DF,aAAa,GAAG,OAAO;MACvBC,WAAW,IAAAC,cAAA,GAAGZ,WAAW,CAAC,CAAC,CAAC,qBAAdY,cAAA,CAAgBlE,IAAI;IACpC;IACA,IAAMmE,cAAc,MAAApD,MAAA,CAClBM,MAAM,CAACO,MAAM,OAAAwB,YAAA,GAAKa,WAAW,qBAAXb,YAAA,CAAanD,EAAE,IAAG,KAAK,IAAAoD,aAAA,GAAGY,WAAW,qBAAXZ,aAAA,CAAa5D,IAAI,OAAAsB,MAAA,CAC3DiD,aAAa,QAAAjD,MAAA,CAAKtB,IAAI,CAAE;IAC5B,OAAO,CACL;MAAE+B,IAAI,EAAE,KAAK;MAAEC,IAAI,EAAE;IAAM,CAAC,EAC5B;MAAED,IAAI,EAAE,KAAK;MAAEC,IAAI,EAAE0C;IAAe,CAAC,CACtC;EACH;EACA,OAAO,CACL;IAAE3C,IAAI,EAAEW,SAAS;IAAEV,IAAI,EAAES;EAAkB,CAAC,EAC5C;IAAEV,IAAI,EAAE,KAAK;IAAEC,IAAI,EAAE5B,CAAC,CAAC,kBAAkB;EAAE,CAAC,CAC7C;AACH,CAAC;AAAC,IAEUuE,iBAAiB,aAAjBA,iBAAiB;EAAjBA,iBAAiB,CAAjBA,iBAAiB;EAAjBA,iBAAiB,CAAjBA,iBAAiB;EAAjBA,iBAAiB,CAAjBA,iBAAiB;EAAA,OAAjBA,iBAAiB;AAAA;AAAAC,OAAA,CAAAD,iBAAA,GAAAA,iBAAA;AAM7B,IAAME,0BAA0B,GAAG,SAA7BA,0BAA0BA,CAG9BlD,OAAoC,EACpCC,MAAsC,EACtC1B,OAAsD,EACtD4E,UAAmB,EACG;EAAA,IAAAC,cAAA;EACtB,IAAM5E,aAAa,GAAGyB,MAAM,CAACO,MAAM;EACnC,IAAI,CAACjC,OAAO,IAAIC,aAAa,OAAA4E,cAAA,GAAK7E,OAAO,CAACK,IAAI,qBAAZwE,cAAA,CAAcvE,EAAE,KAAIsE,UAAU,KAAK,KAAK,EAAE;IAC1E,OAAOH,iBAAiB,CAACK,wBAAwB;EACnD;EAEA,IAAMC,QAAQ,GAAA5C,MAAA,CAAA6C,MAAA,KAAQvD,OAAO,CAACY,KAAK,CAAC4C,IAAI,CAAE;EAC1C,IAAIhF,aAAa,EAAE;IACjB,OAAO8E,QAAQ,CAAC9E,aAAa,CAAC;EAChC;EAEA,IAAMiF,gBAAgB,GAAGlF,OAAO,CAACmF,UAAU,GACvC,OAAOnF,OAAO,CAACmF,UAAU,KAAK,QAAQ,GACpC,IAAIjB,IAAI,CAAClE,OAAO,CAACmF,UAAU,CAAC,GAC5BnF,OAAO,CAACmF,UAAU,GACpBC,SAAS;EAEb,OAAOjD,MAAM,CAACyB,MAAM,CAACmB,QAAQ,CAAC,CAACM,IAAI,CACjC,UAAAC,IAAA;IAAA,IAAGC,SAAS,GAAAD,IAAA,CAATC,SAAS;IAAA,OAAOL,gBAAgB,IAAIA,gBAAgB,GAAGK,SAAS;EAAA,CACrE,CAAC,GACGd,iBAAiB,CAACe,IAAI,GACtBf,iBAAiB,CAACgB,MAAM;AAC9B,CAAC;AAED,IAAMC,uBAAuB,GAAG,SAA1BA,uBAAuBA,CAE3BC,MASD,EAAK;EACJ,IAAQlE,OAAO,GAAoDkE,MAAM,CAAjElE,OAAO;IAAEC,MAAM,GAA4CiE,MAAM,CAAxDjE,MAAM;IAAEkE,WAAW,GAA+BD,MAAM,CAAhDC,WAAW;IAAEjE,SAAS,GAAoBgE,MAAM,CAAnChE,SAAS;IAAEiD,UAAU,GAAQe,MAAM,CAAxBf,UAAU;IAAE1E,CAAC,GAAKyF,MAAM,CAAZzF,CAAC;EAE9D,IAAM2F,QAAQ,GAAGpE,OAAO,CAACY,KAAK,CAACwD,QAAQ;EAEvC,IAAI,CAACA,QAAQ,CAACxE,MAAM,IAAI,CAACuE,WAAW,EAAE;IACpC,OAAO;MACLzB,UAAU,EAAE,EAAE;MACd2B,aAAa,EAAEV,SAAS;MACxBW,QAAQ,EAAE,CACR;QACElE,IAAI,EAAE,KAAK;QACXC,IAAI,EAAE5B,CAAC,CAAC,gBAAgB;MAC1B,CAAC,CACF;MACD8F,MAAM,EAAEvB,iBAAiB,CAACK;IAC5B,CAAC;EACH;EAEA,IAAMmB,uBAAuB,GAAGJ,QAAQ,CAACxE,MAAM,GAAGwE,QAAQ,CAACA,QAAQ,CAACxE,MAAM,GAAG,CAAC,CAAC,GAAG+D,SAAS;EAE3F,IAAMpF,OAAO,GAAG4F,WAAW,KAAKR,SAAS,GAAGQ,WAAW,GAAGK,uBAAuB;EAEjF,OAAO;IACL9B,UAAU,EAAEnE,OAAO,oBAAPA,OAAO,CAAEmE,UAAU;IAC/B2B,aAAa,EAAE9F,OAAO;IACtB+F,QAAQ,EAAEvE,2BAA2B,CAACC,OAAO,EAAEC,MAAM,EAAE1B,OAAO,EAAEE,CAAC,EAAEyB,SAAS,CAAC;IAC7EqE,MAAM,EAAErB,0BAA0B,CAAClD,OAAO,EAAEC,MAAM,EAAE1B,OAAO,EAAE4E,UAAU;EACzE,CAAC;AACH,CAAC;AASM,IAAMsB,uBAAuB,GAAG,SAA1BA,uBAAuBA,CAGlCzE,OAAoC,EACpC0E,WAAmB,EACnBP,WAEuC,EACpC;EAAA,IAAAQ,oBAAA,EAAAC,cAAA;EACH,IAAAC,eAAA,GAAmB,IAAAC,2BAAc,EAAqB,CAAC;IAA/C7E,MAAM,GAAA4E,eAAA,CAAN5E,MAAM;EACd,IAAA8E,qBAAA,GAAc,IAAAC,yCAAqB,EAAC,CAAC;IAA7BvG,CAAC,GAAAsG,qBAAA,CAADtG,CAAC;EAET,IAAMwG,mBAAmB,GAAG,QAAOjF,OAAO,oBAAPA,OAAO,CAAEkF,SAAS,MAAK,UAAU;EAEpE,IAAMC,qBAAqB,GAAG,IAAAC,0CAAoB,EAAqBjB,WAAW,CAAC;EAEnF,IAAMkB,wBAAwB,GAAGF,qBAAqB,GAClD,IAAAG,uBAAgB,EAACH,qBAAqB,CAAC,GACvC,EAAE;EAEN,IAAAI,SAAA,GAAoC,IAAAC,eAAQ,EAAC,IAAI,CAAC;IAAAC,UAAA,OAAAC,eAAA,aAAAH,SAAA;IAA3CpC,UAAU,GAAAsC,UAAA;IAAEE,aAAa,GAAAF,UAAA;EAChC,IAAAG,UAAA,GAAwD,IAAAJ,eAAQ,EAE9D;MACA9C,UAAU,EAAE,EAAE;MACd2B,aAAa,EAAEV,SAAS;MACxBW,QAAQ,EAAE,CACR;QACElE,IAAI,EAAE,KAAK;QACXC,IAAI,EAAE;MACR,CAAC,CACF;MACDkE,MAAM,EAAEvB,iBAAiB,CAACK;IAC5B,CAAC,CAAC;IAAAwC,UAAA,OAAAH,eAAA,aAAAE,UAAA;IAZKE,oBAAoB,GAAAD,UAAA;IAAEE,uBAAuB,GAAAF,UAAA;EAcpD,IAAMG,UAAU,GAAG9C,0BAA0B,CAAClD,OAAO,EAAEC,MAAM,EAAEkF,qBAAqB,EAAEhC,UAAU,CAAC;EAEjG,IAAA8C,gBAAS,EAAC,YAAM;IACd,IAAIhB,mBAAmB,EAAE;MAAA,IAAAiB,kBAAA;MACvB,IAAMC,WAAW,GACf,CAACnG,OAAO,CAACoG,YAAY,IAAI,CAAC,EAACpG,OAAO,YAAPA,OAAO,CAAEnB,EAAE,OAAAqH,kBAAA,GAAIlG,OAAO,CAACkF,SAAS,CAAC,CAAC,qBAAnBgB,kBAAA,CAAqBC,WAAW;MAC5E,IAAI,OAAOA,WAAW,KAAK,SAAS,EAAE;QACpCR,aAAa,CAACQ,WAAW,CAAC;MAC5B;IACF;EAEF,CAAC,EAAE,CAAClB,mBAAmB,CAAC,CAAC;EAEzB,IAAMoB,MAAM,IAAA1B,oBAAA,GAAGR,WAAW,oBAAXA,WAAW,CAAErC,OAAO,YAAA6C,oBAAA,GAAI,EAAE;EACzC,IAAM2B,IAAI,GAAGrG,MAAM,CAACsG,KAAK,CAACC,SAAS,CAACH,MAAM,CAAC;EAC3C,IAAMnG,SAAiD,IAAA0E,cAAA,GACrD,IAAA6B,oBAAa,EAACH,IAAI,oBAAJA,IAAI,CAAE1F,KAAK,EAAE7C,QAAQ,CAAC,YAAA6G,cAAA,GAAI,CAAC,CAAC;EAC5C,IAAQ3G,SAAS,GAAgCiC,SAAS,CAAlDjC,SAAS;IAAEE,mBAAmB,GAAW+B,SAAS,CAAvC/B,mBAAmB;IAAEE,IAAI,GAAK6B,SAAS,CAAlB7B,IAAI;EAE5C,IAAA4H,gBAAS,EACP;IAAA,OACEF,uBAAuB,CACrB9B,uBAAuB,CAAC;MACtBjE,OAAO,EAAPA,OAAO;MACPC,MAAM,EAANA,MAAM;MACNkE,WAAW,EAAEgB,qBAAqB;MAClCjF,SAAS,EAATA,SAAS;MACTiD,UAAU,EAAVA,UAAU;MACV1E,CAAC,EAADA;IACF,CAAC,CACH,CAAC;EAAA,GAEH,CACE4G,wBAAwB,EACxBX,WAAW,EACXvB,UAAU,EACV6C,UAAU,EACV7H,mBAAmB,EACnBF,SAAS,EACTI,IAAI,CAER,CAAC;EAED,OAAOyH,oBAAoB;AAC7B,CAAC;AAAC7C,OAAA,CAAAwB,uBAAA,GAAAA,uBAAA","ignoreList":[]}
